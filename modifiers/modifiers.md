<!-- Code generated by gomarkdoc. DO NOT EDIT -->

# modifiers

```go
import "docxgen/modifiers"
```

## Index

- [Constants](<#constants>)
- [Variables](<#variables>)
- [func Abbr\(s string\) string](<#Abbr>)
- [func Compact\(s string\) string](<#Compact>)
- [func ConcatFactory\(data map\[string\]any\) func\(base string, parts ...string\) string](<#ConcatFactory>)
- [func DateFormat\(val any, layout string\) string](<#DateFormat>)
- [func Declension\(v any, opts ...string\) string](<#Declension>)
- [func DefaultValue\(s, def string\) string](<#DefaultValue>)
- [func Filled\(val any, out string\) string](<#Filled>)
- [func MakePSplit\(fonts \*metrics.FontSet\) func\(text string, firstUnders, otherUnders, nLine any, extra ...any\) string](<#MakePSplit>)
- [func Money\(v any, opts ...string\) string](<#Money>)
- [func NewFuncMap\(opts Options\) template.FuncMap](<#NewFuncMap>)
- [func Nowrap\(s string\) string](<#Nowrap>)
- [func Numeral\(v any, opts ...string\) string](<#Numeral>)
- [func PadLeft\(v any, length int, char string\) string](<#PadLeft>)
- [func PadRight\(v any, length int, char string\) string](<#PadRight>)
- [func Plural\(v any, forms ...string\) string](<#Plural>)
- [func Postfix\(s, p string\) string](<#Postfix>)
- [func Prefix\(s, p string\) string](<#Prefix>)
- [func Replace\(s, old, new string\) string](<#Replace>)
- [func Roman\(v any\) string](<#Roman>)
- [func RuPhone\(s string, formats ...string\) string](<#RuPhone>)
- [func Sign\(v any\) string](<#Sign>)
- [func Truncate\(s string, n int, suffix string\) string](<#Truncate>)
- [func UniqPostfix\(s, p string\) string](<#UniqPostfix>)
- [func UniqPrefix\(s, p string\) string](<#UniqPrefix>)
- [func WordReverse\(s string\) string](<#WordReverse>)
- [func WrapModifier\(fn any, fixed int\) any](<#WrapModifier>)
- [type ModifierMeta](<#ModifierMeta>)
- [type Options](<#Options>)
- [type RawXML](<#RawXML>)
  - [func NewLine\(s string\) RawXML](<#NewLine>)
  - [func QrCode\(value string, opts ...string\) RawXML](<#QrCode>)


## Constants

<a name="TAB"></a>Чтобы Word корректно отображал табуляцию, нужно закрывать предыдущий текстовый элемент. Поэтому при нескольких подряд табах появляются пустые \<w:t\>\</w:t\>, но в Word они всё равно отображаются правильно и выглядят лучше, чем любые другие варианты.

```go
const (
    TAB     = "</w:t><w:tab/><w:t>"
    NEWLINE = "<w:br/>"
)
```

<a name="NBSP"></a>Неразрывные пробелы \(обычный и узкий\)

```go
const (
    NBSP  = "\u00A0" // обычный неразрывный пробел
    NNBSP = "\u202F" // узкий неразрывный пробел
)
```

## Variables

<a name="NewLineInText"></a>

```go
var (
    // NewLineInText - Перенос строки внутри параграфа
    NewLineInText = "</w:t><w:br/><w:t>"
)
```

<a name="QrCodeFunc"></a>

```go
var QrCodeFunc func(string, ...string) RawXML
```

<a name="Abbr"></a>
## func Abbr

```go
func Abbr(s string) string
```

Abbr \- делает сокращения, инициалы и короткие слова неразрывными с последующим словом. Это предотвращает разрыв “г.”, “ул.”, “ООО”, “И.” и т. п. на концах строк.

Примеры:

```
"г. Москва" → "г. Москва"
"И. И. Иванов" → "И. И. Иванов"
"ООО Центр" → "ООО Центр"
```

<a name="Compact"></a>
## func Compact

```go
func Compact(s string) string
```

Compact \- заменяет все пробелы на узкие неразрывные. Подходит для телефонов, номеров документов и таблиц.

Пример:

```
{user_phone|compact} → "+7 (4912) 572-466"
```

<a name="ConcatFactory"></a>
## func ConcatFactory

```go
func ConcatFactory(data map[string]any) func(base string, parts ...string) string
```

ConcatFactory возвращает функцию concat, которая склеивает строку с тегами или текстом. Последний параметр всегда считается разделителем.

Примеры:

```
{own_org_name|concat:`own_org_address`:`position`:`department`:`, `}
→ "ООО Рога, Москва, Отдел продаж"

{abc_tag|concat:`не тег`:`def_tag`:` разделитель `}
→ "A разделитель не тег разделитель B"

{fio|concat:`prefix`:`postfix`:`, `}
→ "Иванов Иван Иванович, prefix, postfix"
```

<a name="DateFormat"></a>
## func DateFormat

```go
func DateFormat(val any, layout string) string
```

DateFormat — форматирует дату по шаблону Go \(например, "02.01.2006"\).

Примеры:

```
{project.deadline|date_format:`02.01.2006`} → "01.03.2026"
{created_at|date_format:`02.01.2006 15:04`} → "14.10.2025 08:30"
```

<a name="Declension"></a>
## func Declension

```go
func Declension(v any, opts ...string) string
```

Declension — склоняет ФИО в указанный падеж и формат, используя petrovich\-go. Если приходит строка "Фамилия Имя Отчество" — делает автоматическое склонение. Если приходит map\[string\]string с готовыми формами — выбирает нужную.

Примеры:

```
{user_fio|declension:`предложный`:`ф и о`} = "Иванову Ивану Ивановичу"
{user_fio|declension:`дательный`:`фамилия и.о.`} = "Сидорову И.П."
{user_fio|declension:`винительный`:`фамилия`} = "Петрова"
{user_fio|decl:`п`:`и.о. ф`} = "И.И. Сидорову"
```

<a name="DefaultValue"></a>
## func DefaultValue

```go
func DefaultValue(s, def string) string
```

DefaultValue — вернуть значение по умолчанию, если строка пустая.

Пример:

```
{position|default:`сотрудник`} → "сотрудник"
```

<a name="Filled"></a>
## func Filled

```go
func Filled(val any, out string) string
```

Filled — вернуть указанное значение, если строка непустая; иначе пусто.

Пример:

```
{passport|filled:`—`} → "—"
```

<a name="MakePSplit"></a>
## func MakePSplit

```go
func MakePSplit(fonts *metrics.FontSet) func(text string, firstUnders, otherUnders, nLine any, extra ...any) string
```

MakePSplit — модификатор p\_split, реализует переносы строк как в офисных редакторах, но только в таблицах, где текст нужно раскидать равномерно по ячейкам.

В шаблоне дизайнер руками проставляет строки из подчёркиваний "\_". По их количеству мы узнаем сколько символов «влезет» в строку. Далее заводится тег с модификатором p\_split вместо этих подчеркиваний. При написании модификатора p\_split количество подчеркиваний указывается в параметрах. Программа сама пересчитает количество подчеркиваний в pt исходя из размера текста, начертания.

Алгоритм: текст делится на слова и раскладывается по строкам, чтобы слова не рвались и каждая строка укладывалась в заданное число символов.

Параметры \(через двоеточие\):

```
{tag|p_split:<indentCount>:<lineCount>:<nLine>[:<style>:<fontSize>]}
• indentCount — количество подчёркиваний в первой строке (если есть абзацный отступ);
                если отступа нет, indentCount = lineCount;
• lineCount   — количество подчёркиваний во всех последующих строках;
• nLine       — номер строки, которую нужно взять;
                если указано с плюсом (например, +2), берутся все строки начиная с этой;
• style       — (необязательно) стиль шрифта: regular, bold, italic, bolditalic;
• fontSize    — (необязательно) размер шрифта (10, 12, 14 и т. д.).
```

Примеры:

```
{address|p_split:20:65:1}        → первая строка адреса (20 подчёркиваний, затем 65)
{address|p_split:20:65:2}        → вторая строка адреса
{address|p_split:20:65:+2}       → вторая и все последующие строки
{fio|p_split:15:60:1:`bold`:12}    → первая строка, жирный 12 pt
```

<a name="Money"></a>
## func Money

```go
func Money(v any, opts ...string) string
```

Money — форматирует число как денежное значение с разделением тысяч пробелами. Поддерживает флаг "int" / "целое" для скрытия дробной части, а также пользовательский формат через шаблон fmt.Sprintf.

Примеры:

```
{sum|money}                    → "1 234,56"
{sum|money:`int`}              → "1 234"
{sum|money:`целое`}            → "1 234"
{sum|money:`%s рублей`}        → "1 234 рублей"
{sum|money:`%s рублей %02d копеек`} → "1 234 рублей 56 копеек"
```

Если шаблон содержит только один плейсхолдер \(%s\), дробная часть будет опущена. Некорректный формат не вызывает паники — просто игнорируется.

<a name="NewFuncMap"></a>
## func NewFuncMap

```go
func NewFuncMap(opts Options) template.FuncMap
```

NewFuncMap возвращает карту функций для Go\-шаблонов. Подключает стандартные модификаторы и сливает ExtraFuncs поверх.

<a name="Nowrap"></a>
## func Nowrap

```go
func Nowrap(s string) string
```

Nowrap \- заменяет все обычные пробелы на неразрывные. Используется для коротких кодов, индексов, номеров.

Пример:

```
{case_index|nowrap} → "Дело № 15"
```

<a name="Numeral"></a>
## func Numeral

```go
func Numeral(v any, opts ...string) string
```

Numeral — числовой модификатор с морфологией \(род, падеж, вариант 8, вариант нуля\).

Примеры:

```
{count|numeral} → "один"
{count|numeral:`предложный`} → "одном"
{count|numeral:`женский`:`предложный`} → "одной"
{count|numeral:`предложный`:`ноль`} → "ноле"
{count|numeral:`женский`:`творительный`:`восемью`:`нуль`} → "восемью"
{35147|numeral:`дательный`} → "тридцати пяти тысячам ста сорока семи"
```

<a name="PadLeft"></a>
## func PadLeft

```go
func PadLeft(v any, length int, char string) string
```

PadLeft — дополняет строку слева символом до указанной длины.

Пример:

```
{num|pad_left:`5`:`0`} → "00042"
```

<a name="PadRight"></a>
## func PadRight

```go
func PadRight(v any, length int, char string) string
```

PadRight — дополняет строку справа символом до указанной длины.

Пример:

```
{num|pad_right:`3`:`0`} → "420"
```

<a name="Plural"></a>
## func Plural

```go
func Plural(v any, forms ...string) string
```

Plural — склонение существительных по числу. v — значение \(число или строка с числом\), forms — три формы слова: \["сотрудник", "сотрудника", "сотрудников"\].

Примеры:

```
{count|plural:`день`:`дня`:`дней`}        → "дня"
{files|plural:`файл`:`файла`:`файлов`}   → "файлов"
{users|plural}                           → "сотрудников"
```

<a name="Postfix"></a>
## func Postfix

```go
func Postfix(s, p string) string
```

Postfix — добавить постфикс к строке, если она не пустая.

Пример:

```
{sum|postfix:` руб.`} → "100 руб."
```

<a name="Prefix"></a>
## func Prefix

```go
func Prefix(s, p string) string
```

Prefix — добавить префикс к строке, если она не пустая.

Пример:

```
{fio|prefix:`гражданин `} → "гражданин Иванов Иван Иванович"
```

<a name="Replace"></a>
## func Replace

```go
func Replace(s, old, new string) string
```

Replace — заменить все вхождения подстроки.

Пример:

```
{address|replace:`Москва`:`Санкт-Петербург`}
```

<a name="Roman"></a>
## func Roman

```go
func Roman(v any) string
```

Roman — переводит число в римские цифры.

Пример:

```
{page|roman} → "XIV"
```

<a name="RuPhone"></a>
## func RuPhone

```go
func RuPhone(s string, formats ...string) string
```

RuPhone \- форматирует российские номера телефонов по шаблонам. Если номер не распознан, возвращает исходную строку.

Примеры:

```
{user_phone|phone} → "+7 (4912) 572-466"
{user_phone|phone:`тел.: +7 ($2) $3-$4-$5`:`тел.: +7 ($2) $3-$4`}
```

Параметры:

- без параметров — используется стандартный формат;
- 1 параметр — шаблон для мобильного телефона;
- 2 параметра — шаблон для мобильного и регионального телефона.

<a name="Sign"></a>
## func Sign

```go
func Sign(v any) string
```

Sign — добавляет знак "\+" к положительным числам.

Примеры:

```
{delta|sign} → "+5"
{-3|sign} → "-3"
{0|sign} → "0"
```

<a name="Truncate"></a>
## func Truncate

```go
func Truncate(s string, n int, suffix string) string
```

Truncate — обрезать строку до n символов, при необходимости добавить хвост \(например, "…"\).

Пример:

```
{title|truncate:`20`:`…`} → "Очень длинное заг…"
```

<a name="UniqPostfix"></a>
## func UniqPostfix

```go
func UniqPostfix(s, p string) string
```

UniqPostfix — добавить постфикс только если строка непустая и ещё не оканчивается на него.

Пример:

```
{city|uniqpostfix:` г.`} → "Москва г."
```

<a name="UniqPrefix"></a>
## func UniqPrefix

```go
func UniqPrefix(s, p string) string
```

UniqPrefix — добавить префикс только если строка непустая и ещё не начинается с него.

Пример:

```
{org|uniqprefix:`ООО `} → "ООО Ромашка"
```

<a name="WordReverse"></a>
## func WordReverse

```go
func WordReverse(s string) string
```

WordReverse — меняет порядок слов в строке на обратный.

Примеры:

```
{fio|word_reverse}
  "Фамилия Имя Отчество" → "Отчество Имя Фамилия"

{phrase|word_reverse}
  "раз два три четыре" → "четыре три два раз"
```

<a name="WrapModifier"></a>
## func WrapModifier

```go
func WrapModifier(fn any, fixed int) any
```

WrapModifier — единая обёртка вызова модификатора. Делает разбор аргументов по правилу DSL: первые "fixed" — фиксированные, последний — pipeline\-value, всё между ними — "formats". Затем вызывает целевую функцию в виде:

```
fn(value, fixed..., formats...)
```

Поддерживает вариадики. gomarkdoc:ignore

<a name="ModifierMeta"></a>
## type ModifierMeta



```go
type ModifierMeta struct {
    Fn    any // целевая функция (с "красивой" сигнатурой)
    Count int // сколько ПЕРВЫХ аргументов считать фиксированными; pipeline-value всегда последний
}
```

<a name="Options"></a>
## type Options

Options задаёт параметры построения FuncMap.

```go
type Options struct {
    // Fonts — набор шрифтов для p_split. Если nil, p_split не подключаем.
    Fonts *metrics.FontSet
    // Data — входные данные шаблона (нужны для concat, чтобы уметь подцеплять другие теги по имени).
    Data map[string]any
    // ExtraFuncs — пользовательские модификаторы с количеством фиксированных параметров.
    // Поведение полностью аналогично builtins.
    ExtraFuncs map[string]ModifierMeta
}
```

<a name="RawXML"></a>
## type RawXML

RawXML — тип для "сырых" XML\-вставок, которые не нужно экранировать.

```go
type RawXML string
```

<a name="NewLine"></a>
### func NewLine

```go
func NewLine(s string) RawXML
```

NewLine — добавить перенос к строке.

<a name="QrCode"></a>
### func QrCode

```go
func QrCode(value string, opts ...string) RawXML
```

QrCode — вставляет QR\-код по заданному значению прямо в документ.

Пример использования:

```
{project.code|qrcode:`right`:`top`:`8%`:`5/5`:`border`}
```

Формат:

```
{значение|qrcode:[mode]:[align]:[valign]:[crop%]:[margins]:[border]}
```

Параметры \(все необязательные, порядок не важен\):

- mode — "anchor" \(по умолчанию\) или "inline" Режим вставки: плавающий \(anchor\) или встроенный в текст \(inline\).

- align — "left", "center", "right" Горизонтальное выравнивание для режима anchor \(по умолчанию "right"\).

- valign — "top", "middle", "bottom" Вертикальное выравнивание \(по умолчанию "top"\). "middle" — синоним "center".

- \<N\>mm — размер QR\-кода в миллиметрах \(по умолчанию 32 мм\).

- \<N\>% — кроп \(обрезка белых полей вокруг QR\-кода\), по умолчанию 4 %.

- margins — отступы от текста, в миллиметрах. Форматы: "5/5" — верх/низ = 5 мм, лево/право = 5 мм; "5/3/5/3" — top/right/bottom/left отдельно; "5/3/7" — top, боковые, низ.

- border — флаг, добавляет тонкую чёрную рамку \(≈ 0.5 pt\) вокруг QR\-кода.

Возвращает:

```
Вставляемый XML-фрагмент <w:drawing> с сгенерированным QR-изображением.
```

Generated by [gomarkdoc](<https://github.com/princjef/gomarkdoc>)
