# üìÑ docxgen ‚Äî –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ DOCX-–¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –Ω–∞ Go

**docxgen** ‚Äî —ç—Ç–æ –º–æ—â–Ω–∞—è –∏ –ø—Ä–æ—Å—Ç–∞—è Go-–±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ DOCX (Word) –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ —à–∞–±–ª–æ–Ω–æ–≤.  
–û–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≤–ª–æ–∂–µ–Ω–Ω—ã–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã, —Ü–∏–∫–ª—ã, —Ç–∞–±–ª–∏—Ü—ã, –ø–æ–¥—Å—Ç–∞–Ω–æ–≤–∫–∏ –¥–∞–Ω–Ω—ã—Ö, –≤—Å—Ç–∞–≤–∫—É QR/—à—Ç—Ä–∏—Ö-–∫–æ–¥–æ–≤, –∞ —Ç–∞–∫–∂–µ —Ä–∞–±–æ—Ç—É —Å XML-—Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞–º–∏.

---

## üöÄ –£—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
go get github.com/normiridium/docxgen
```

---

## üß© –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

| –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å | –û–ø–∏—Å–∞–Ω–∏–µ |
|--------------|-----------|
| üîπ **–®–∞–±–ª–æ–Ω–∏–∑–∞—Ü–∏—è DOCX** | –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞ `{var}`, `{if}`, `{range}` –∏ –º–æ–¥–∏—Ñ–∏–∫–∞—Ç–æ—Ä–æ–≤ |
| üîπ **–¶–∏–∫–ª—ã –∏ —É—Å–ª–æ–≤–∏—è** | –ò—Å–ø–æ–ª—å–∑—É–π `{{range}}`, `{{if}}`, `{{else}}`, –∫–∞–∫ –≤ Go templates |
| üîπ **–ö–∞—Å—Ç–æ–º–Ω—ã–µ –º–æ–¥–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã** | –î–æ–±–∞–≤–ª—è–π —Å–≤–æ–∏ —Ñ—É–Ω–∫—Ü–∏–∏ —á–µ—Ä–µ–∑ `AddModifier` |
| üîπ **–í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –º–æ–¥–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã** | `upper`, `lower`, `wrap`, `gender_select`, `qrcode`, `barcode` |
| üîπ **–†–∞–±–æ—Ç–∞ —Å —Ö–µ–¥–µ—Ä–∞–º–∏/—Ñ—É—Ç–µ—Ä–∞–º–∏** | –ò–∑–º–µ–Ω–µ–Ω–∏–µ `headerX`, `footerX` —Ä–∞–∑–¥–µ–ª–æ–≤ |
| üîπ **–ò–Ω–∫–ª—é–¥—ã** | –ü–æ–¥–¥–µ—Ä–∂–∫–∞ `[include/file]` –≤–Ω—É—Ç—Ä–∏ —à–∞–±–ª–æ–Ω–∞ |
| üîπ **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –ø–æ—Ç–æ–∫** | `SaveToWriter(w)` ‚Äî —É–¥–æ–±–Ω–æ –¥–ª—è HTTP API |
| üîπ **–®—Ä–∏—Ñ—Ç—ã –¥–ª—è —Ä–∞–∑–±–∏–µ–Ω–∏—è —Ç–µ–∫—Å—Ç–∞** | `LoadFontsForPSplit()` –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ –ø–æ–¥—Å—á—ë—Ç–∞ —à–∏—Ä–∏–Ω—ã |
| üîπ **–ò–º–ø–æ—Ä—Ç —Ç–∞–±–ª–∏—Ü –∏ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö** | —á–µ—Ä–µ–∑ `{range}` –∏ `[table/]` –±–ª–æ–∫–∏ |
| üîπ **PDF-–∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è (CLI)** | –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ —Ä–µ–∂–∏–º–µ `--pdf` |

---

## ‚ö° –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

```go
package main

import (
	"docxgen"
	"docxgen/modifiers"
	"fmt"
	"strings"
)

func main() {
	// 1. –û—Ç–∫—Ä—ã–≤–∞–µ–º —à–∞–±–ª–æ–Ω
	doc, err := docxgen.Open("examples/template.docx")
	if err != nil {
		panic(err)
	}

	// 2. –ü–æ–¥–∫–ª—é—á–∞–µ–º –∫–∞—Å—Ç–æ–º–Ω—ã–µ –º–æ–¥–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã
	doc.ImportModifiers(map[string]modifiers.ModifierMeta{
		"upper": {Fn: func(s string) string { return strings.ToUpper(s) }, Count: 0},
		"wrap":  {Fn: func(v, l, r string) string { return l + v + r }, Count: 2},
	})

	// 3. –ì–æ—Ç–æ–≤–∏–º –¥–∞–Ω–Ω—ã–µ –¥–ª—è —à–∞–±–ª–æ–Ω–∞
	data := map[string]any{
		"fio":     "–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤–∏—á",
		"project": "–®–∞–±–ª–æ–Ω–∏–∑–∞—Ç–æ—Ä DocX",
		"items": []map[string]any{
			{"n": 1, "task": "–ò–º–ø–æ—Ä—Ç JSON"},
			{"n": 2, "task": "–†–µ–Ω–¥–µ—Ä DOCX"},
			{"n": 3, "task": "–ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –≤ PDF"},
		},
	}

	// 4. –í—ã–ø–æ–ª–Ω—è–µ–º —à–∞–±–ª–æ–Ω
	if err := doc.ExecuteTemplate(data); err != nil {
		panic(err)
	}

	// 5. –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
	if err := doc.Save("result.docx"); err != nil {
		panic(err)
	}

	fmt.Println("üíö –î–æ–∫—É–º–µ–Ω—Ç —Å–æ–∑–¥–∞–Ω: result.docx")
}
```

---

## üßæ –ü—Ä–∏–º–µ—Ä —à–∞–±–ª–æ–Ω–∞ Word

–ü—Ä–∏–º–µ—Ä —à–∞–±–ª–æ–Ω–∞ (`template.docx`):

```
–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ, {fio|upper}!

–í–∞—à –ø—Ä–æ–µ–∫—Ç: {project}

–°–ø–∏—Å–æ–∫ –∑–∞–¥–∞—á:
{range .items}
  {n}. {task}
{/range}
```

–†–µ–∑—É–ª—å—Ç–∞—Ç:

```
–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ, –ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤–∏—á!

–í–∞—à –ø—Ä–æ–µ–∫—Ç: –®–∞–±–ª–æ–Ω–∏–∑–∞—Ç–æ—Ä DocX

–°–ø–∏—Å–æ–∫ –∑–∞–¥–∞—á:
  1. –ò–º–ø–æ—Ä—Ç JSON
  2. –†–µ–Ω–¥–µ—Ä DOCX
  3. –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –≤ PDF
```

---

## üß† –ü—Ä–∏–º–µ—Ä —Å –º–æ–¥–∏—Ñ–∏–∫–∞—Ç–æ—Ä–∞–º–∏

| –ú–æ–¥–∏—Ñ–∏–∫–∞—Ç–æ—Ä | –ü—Ä–∏–º–µ—Ä                                         | –†–µ–∑—É–ª—å—Ç–∞—Ç |
|--------------|------------------------------------------------|------------|
| `wrap` | `{fio\|wrap:"<<":">>"}`                        | <<–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤–∏—á>> |
| `gender_select` | `{fio\|gender_select:"–£–≤–∞–∂–∞–µ–º—ã–π":"–£–≤–∞–∂–∞–µ–º–∞—è"}` | –≤—ã–±–∏—Ä–∞–µ—Ç —Ñ–æ—Ä–º—É –ø–æ –ø–æ–ª—É/–§–ò–û |
| `qrcode` | `{fio\|qrcode}`                                | –≤—Å—Ç–∞–≤–ª—è–µ—Ç QR-–∫–æ–¥ |
| `barcode` | `{code\|barcode}`                              | –≤—Å—Ç–∞–≤–ª—è–µ—Ç —à—Ç—Ä–∏—Ö–∫–æ–¥ |

---

## üß© –†–∞–±–æ—Ç–∞ —Å XML –∏ –ø–æ—Ç–æ–∫–∞–º–∏

–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –ø—Ä—è–º—É—é —Ä–∞–±–æ—Ç—É —Å XML –∏ –ø–æ—Ç–æ–∫–æ–≤—ã–π –≤—ã–≤–æ–¥ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≤ HTTP-–æ—Ç–≤–µ—Ç):

```go
func handler(w http.ResponseWriter, r *http.Request) {
	data := map[string]any{"fio": "–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤–∏—á"}
	doc, _ := docxgen.Open("examples/template.docx")
	doc.ExecuteTemplate(data)

	w.Header().Set("Content-Type", "application/vnd.openxmlformats-officedocument.wordprocessingml.document")
	w.Header().Set("Content-Disposition", "attachment; filename=result.docx")
	_ = doc.SaveToWriter(w)
}
```

---

## üì¶ –†–∞–±–æ—Ç–∞ —Å –º–µ–¥–∏–∞

–¢—ã –º–æ–∂–µ—à—å –¥–æ–±–∞–≤–ª—è—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤—Ä—É—á–Ω—É—é:

```go
imageData, _ := os.ReadFile("photo.png")
rID, _ := doc.AddImageRel(imageData)
fmt.Println("image id:", rID)
```

–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–∏—Ç —Å–≤—è–∑–∏ (`.rels`) –∏ —Ç–∏–ø—ã –∫–æ–Ω—Ç–µ–Ω—Ç–∞ (`[Content_Types].xml`).

---

## ‚öôÔ∏è –û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã

| –ú–µ—Ç–æ–¥ | –û–ø–∏—Å–∞–Ω–∏–µ |
|--------|-----------|
| `Open(path)` | –û—Ç–∫—Ä—ã–≤–∞–µ—Ç DOCX –∏ —Ä–∞—Å–ø–∞–∫–æ–≤—ã–≤–∞–µ—Ç –≤—Å–µ —Ñ–∞–π–ª—ã |
| `Save(path)` | –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –¥–æ–∫—É–º–µ–Ω—Ç –æ–±—Ä–∞—Ç–Ω–æ –≤ DOCX |
| `SaveToWriter(w io.Writer)` | –ü–∏—à–µ—Ç DOCX –≤ –ø–æ—Ç–æ–∫ (HTTP –∏ —Ç.–¥.) |
| `ExecuteTemplate(data map[string]any)` | –í—ã–ø–æ–ª–Ω—è–µ—Ç —à–∞–±–ª–æ–Ω —Å –ø–æ–¥—Å—Ç–∞–Ω–æ–≤–∫–æ–π |
| `ContentPart("document")` | –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç XML –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞ |
| `UpdateContentPart("document", xml)` | –ó–∞–º–µ–Ω—è–µ—Ç XML-—Ñ—Ä–∞–≥–º–µ–Ω—Ç |
| `ImportModifiers(map[string]ModifierMeta)` | –î–æ–±–∞–≤–ª—è–µ—Ç –∫–∞—Å—Ç–æ–º–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ |
| `AddModifier(name, fn, args)` | –î–æ–±–∞–≤–ª—è–µ—Ç –æ—Ç–¥–µ–ª—å–Ω—ã–π –º–æ–¥–∏—Ñ–∏–∫–∞—Ç–æ—Ä |
| `LoadFontsForPSplit(...)` | –ü–æ–¥–∫–ª—é—á–∞–µ—Ç —à—Ä–∏—Ñ—Ç—ã –¥–ª—è p_split |
| `AddImageRel(data []byte)` | –î–æ–±–∞–≤–ª—è–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤ –¥–æ–∫—É–º–µ–Ω—Ç |

---

## üß© –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ

–í —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ –µ—Å—Ç—å –≥–æ—Ç–æ–≤–∞—è **CLI-—É—Ç–∏–ª–∏—Ç–∞** –≤ –∫–∞—Ç–∞–ª–æ–≥–µ [`main/`](./main/):

```bash
go run ./main --in examples/template.docx --data examples/data.json --out examples/result.docx
```

CLI –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç:
- —Å–ª–µ–∂–µ–Ω–∏–µ –∑–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏ (`--watch`),
- HTTP-–¥–µ–º–æ–Ω (`--serve`),
- –≤—ã–≤–æ–¥ PDF (`--pdf`),
- –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä PDF (`--pdf-preview`).

---

## ü™∂ –õ–∏—Ü–µ–Ω–∑–∏—è

MIT ¬© 2025 ‚Äî normiridium  
–°–æ–∑–¥–∞–Ω–æ —Å –ª—é–±–æ–≤—å—é –∏ –≤–Ω–∏–º–∞–Ω–∏–µ–º –∫ –¥–µ—Ç–∞–ª—è–º üìÑ
